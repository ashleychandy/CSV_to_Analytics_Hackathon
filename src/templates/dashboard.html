<!DOCTYPE html>
<html>
  <head>
    <title>ETL Dashboard</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', path='css/style.css') }}"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <div class="container">
      <h1>ETL Process Monitor</h1>

      <div class="status-panel">
        <h2>Current Status</h2>
        <div id="status">{{ status }}</div>
      </div>

      <div class="actions">
        <button onclick="runETL()">Run ETL Process</button>
        <button onclick="exportData()">Export Data</button>
      </div>

      <div class="metrics">
        <h2>System Metrics</h2>
        <div class="metric-grid">
          <div class="metric-card">
            <h3>Processed Records</h3>
            <div id="processed-count">0</div>
          </div>
          <div class="metric-card">
            <h3>Processing Time</h3>
            <div id="processing-time">0s</div>
          </div>
          <div class="metric-card">
            <h3>Last Update</h3>
            <div id="last-update">Never</div>
          </div>
        </div>
      </div>

      <div class="upload-panel">
        <h2>Upload Transactions</h2>
        <form id="upload-form" enctype="multipart/form-data">
          <input type="file" id="csv-file" accept=".csv" />
          <button type="submit">Upload CSV</button>
        </form>
        <div id="upload-status"></div>
      </div>

      <div class="analytics-panel">
        <h2>Analytics</h2>
        <div class="analytics-grid">
          <div class="analytics-card">
            <h3>Total Sales</h3>
            <div id="total-sales">0</div>
          </div>
          <div class="analytics-card">
            <h3>Total Transactions</h3>
            <div id="total-transactions">0</div>
          </div>
          <div class="analytics-card">
            <h3>Average Transaction Value</h3>
            <div id="avg-transaction">0</div>
          </div>
        </div>
        <div class="charts-grid">
          <div class="chart-container">
            <h3>Sales by Tender Type</h3>
            <canvas id="tenderChart"></canvas>
          </div>
          <div class="chart-container">
            <h3>Sales by Store</h3>
            <canvas id="storeChart"></canvas>
          </div>
        </div>
      </div>

      <div class="data-panel">
        <h2>Transaction Data</h2>
        <div class="table-container">
          <table id="data-table">
            <thead>
              <tr>
                <th>Store</th>
                <th>Date</th>
                <th>Time</th>
                <th>Transaction #</th>
                <th>Amount</th>
                <th>Quantity</th>
                <th>Tender</th>
              </tr>
            </thead>
            <tbody id="data-body"></tbody>
          </table>
          <div class="pagination">
            <button onclick="previousPage()">&laquo; Previous</button>
            <span id="page-info">Page 1</span>
            <button onclick="nextPage()">Next &raquo;</button>
          </div>
        </div>
      </div>
    </div>

    <script src="{{ url_for('static', path='js/dashboard.js') }}"></script>
  </body>
</html>
